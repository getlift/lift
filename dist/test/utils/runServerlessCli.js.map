{
  "version": 3,
  "sources": ["../../../test/utils/runServerlessCli.ts"],
  "sourcesContent": ["import { spawn } from \"child_process\";\nimport { readFileSync } from \"fs\";\nimport * as path from \"path\";\n\nexport async function runServerlessCli({ command, fixture }: RunServerlessCliOptions): Promise<RunServerlessCliReturn> {\n    return new Promise((resolve, reject) => {\n        const serverlessCmd = path.join(__dirname, \"../../node_modules/.bin/serverless\");\n        const process = spawn(`${serverlessCmd} ${command}`, {\n            shell: true,\n            cwd: path.join(__dirname, \"../fixtures\", fixture),\n        });\n        let output = \"\";\n        process.stdout.on(\"data\", (data) => (output += data));\n        process.stderr.on(\"data\", (data) => (output += data));\n        process.on(\"data\", (data) => resolve(data));\n        process.on(\"error\", (err) => reject(new Error(`Exit code: ${err.message}\\n` + output)));\n        process.on(\"close\", (err) => {\n            if (err === 0) {\n                const json = readFileSync(\n                    __dirname + \"/../fixtures/variables/.serverless/cloudformation-template-update-stack.json\"\n                );\n                resolve({\n                    stdoutData: output,\n                    cfTemplate: JSON.parse(json.toString()) as {\n                        Resources: Record<string, unknown>;\n                        Outputs: Record<string, unknown>;\n                    },\n                });\n            } else {\n                reject(new Error(`Exit code: ${err}\\n` + output));\n            }\n        });\n    });\n}\n\ntype RunServerlessCliOptions = {\n    fixture: string;\n    command: string;\n};\n\ntype RunServerlessCliReturn = {\n    stdoutData: string;\n    cfTemplate: {\n        Resources: Record<string, unknown>;\n        Outputs: Record<string, unknown>;\n    };\n};\n"],
  "mappings": ";;;;;;;;;;;;;;;;;;;;;;;AAAA;AAAA;AAAA;AAAA,2BAAsB;AACtB,gBAA6B;AAC7B,WAAsB;AAEtB,gCAAuC,EAAE,SAAS,WAAqE;AACnH,SAAO,IAAI,QAAQ,CAAC,SAAS,WAAW;AACpC,UAAM,gBAAgB,KAAK,KAAK,WAAW;AAC3C,UAAM,UAAU,gCAAM,GAAG,iBAAiB,WAAW;AAAA,MACjD,OAAO;AAAA,MACP,KAAK,KAAK,KAAK,WAAW,eAAe;AAAA;AAE7C,QAAI,SAAS;AACb,YAAQ,OAAO,GAAG,QAAQ,CAAC,SAAU,UAAU;AAC/C,YAAQ,OAAO,GAAG,QAAQ,CAAC,SAAU,UAAU;AAC/C,YAAQ,GAAG,QAAQ,CAAC,SAAS,QAAQ;AACrC,YAAQ,GAAG,SAAS,CAAC,QAAQ,OAAO,IAAI,MAAM,cAAc,IAAI;AAAA,IAAc;AAC9E,YAAQ,GAAG,SAAS,CAAC,QAAQ;AACzB,UAAI,QAAQ,GAAG;AACX,cAAM,OAAO,4BACT,YAAY;AAEhB,gBAAQ;AAAA,UACJ,YAAY;AAAA,UACZ,YAAY,KAAK,MAAM,KAAK;AAAA;AAAA,aAK7B;AACH,eAAO,IAAI,MAAM,cAAc;AAAA,IAAU;AAAA;AAAA;AAAA;AAAA;",
  "names": []
}
